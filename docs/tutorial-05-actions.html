<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5L24P7Z');</script><!-- End Google Tag Manager -->
    <meta charset="utf-8">
    <title>JSDoc: 06. Customize actions</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
    <link type="text/css" rel="stylesheet" href="styles/app.min.css">
</head>

<body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
        <div class="container">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                     
                        <img src="images/logo.png" alt="logo">
                    
                     
                        <h1 class="navbar-item">AdminBro Documentation</h1>
                    
                    <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                 
                <div class="navbar-menu">
                    <div class="navbar-end">
                    
                        <div class="navbar-item">
                            <a href="https://github.com/SoftwareBrothers/admin-bro" target="_blank">Github</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://admin-bro-example-app.herokuapp.com/admin" target="_blank">Example Application</a>
                        </div>
                    
                    </div>
                </div>
                
            </nav>
        </div>
    </div>
    <div class="container">
        <div class="columns">
            <div class="column is-3" id="sidebarNav">
                <div class="sidebar">
                    <nav>
                        <h2><a href="index.html">Home</a></h2><div class="category"><h3>Tutorials</h3><ul><li><a href="tutorial-01-example.html">01. Example App</a></li><li><a href="tutorial-02-frameworks.html">02. Frameworks</a></li><li><a href="tutorial-03-passing-resources.html">03. Adding resources</a></li><li><a href="tutorial-04-customizing-resources.html">04. Customize resources</a></li><li><a href="tutorial-05-actions.html">06. Customize actions</a></li><li><a href="tutorial-06-custom-dashboard.html">05. Customize dashboard</a></li><li><a href="tutorial-07-architecture.html">06. Architecture</a></li></ul><h3>Modules</h3><ul><li><a href="module-admin-bro-expressjs.html">admin-bro-expressjs</a></li><li><a href="module-admin-bro-hapijs.html">admin-bro-hapijs</a></li><li><a href="module-admin-bro-mongoose.html">admin-bro-mongoose</a></li><li><a href="module-admin-bro-sequelizejs.html">admin-bro-sequelizejs</a></li></ul><h3>Classes</h3><ul><li><a href="AdminBro.html">AdminBro</a></li><li><a href="PageBuilder.html">PageBuilder</a></li><li><a href="ViewHelpers.html">ViewHelpers</a></li></ul><h3><a href="global.html">Global</a></h3></div><div class="category"><h2>PropertyTypes</h2><h3>Modules</h3><ul><li><a href="module-boolean.html">boolean</a></li><li><a href="module-date.html">date</a></li><li><a href="module-datetime.html">datetime</a></li><li><a href="module-defaultType.html">defaultType</a></li><li><a href="module-richtext.html">richtext</a></li><li><a href="module-string.html">string</a></li></ul></div><div class="category"><h2>Adapter</h2><h3>Classes</h3><ul><li><a href="BaseDatabase.html">BaseDatabase</a></li><li><a href="BaseProperty.html">BaseProperty</a></li><li><a href="BaseRecord.html">BaseRecord</a></li><li><a href="BaseResource.html">BaseResource</a></li></ul></div><div class="category"><h2>Errors</h2><h3>Classes</h3><ul><li><a href="NotImplementedError.html">NotImplementedError</a></li><li><a href="ValidationError.html">ValidationError</a></li></ul></div><div class="category"><h2>Decorators</h2><h3>Classes</h3><ul><li><a href="PropertyDecorator.html">PropertyDecorator</a></li><li><a href="ResourceDecorator.html">ResourceDecorator</a></li></ul></div>
                    </nav>
                </div>
            </div>
            <div class="column is-9-desktop">
                <div class="content" id="main-content-wrapper">
                    <header class="page-title">
                        <p>Tutorial</p>
                        <h1>06. Customize actions</h1>
                    </header>
                    
                    <section>

<header>
    
</header>

<article>
    <p>At some point you would probably like to customize default views or create custom actions. <a href="global.html#Action">Actions</a> are the way of doing that.</p>
<h2>Default actions</h2><p>Admin bro has 4 major default actions defined for each resource:</p>
<p><strong>Resource</strong> base actions:</p>
<ul>
<li><strong>new</strong> [Add new] - creates new record</li>
</ul>
<p><strong>Record</strong> base actions:</p>
<ul>
<li><strong>show</strong> [info] - shows details of a given record</li>
<li><strong>edit</strong> [edit] - updates given record</li>
<li><strong>delete</strong> [remove] - removes given record</li>
</ul>
<p><strong>Resource base actions</strong> can be accessed in the header of the list of all the resources (next to the <em>filters</em> button). <strong>Record actions</strong> are places in the list by the resource. Take a look at the following screenshot:</p>
<p><img src="/images/actions.png"></p>
<p>Default actions can be accessed right from the AdminBro class.</p>
<pre class="prettyprint source lang-javascript"><code>
const AdminBro = require('admin-bro)
AdminBro.ACTIONS.show // => show action object</code></pre><h2>Modify default action per Resource</h2><p>Each action has all the parameters defined by <a href="global.html#Action">Action</a>. They can be modified per resource along with other <a href="global.html#ResourceOptions">ResourceOptions</a></p>
<pre class="prettyprint source lang-javascript"><code>const adminBroOptions = {
  resources: [
    { resource: Article, options: { actions: {show: {}, edit: {}, ...} } },
  ],
}</code></pre><h3>Basic properties</h3><p>Yes - you can modify things like: label, icon and visibility.</p>
<p>In the folowing example we will change name of show action along with the icon, and will show it only for records with an email.</p>
<pre class="prettyprint source lang-javascript"><code>const adminBroOptions = {
  resources: [
    { resource: Article,
      options: {
        actions: {
          show: {
            label: 'Show me that',
            icon: 'fas fa-eye',
            isVisible: (resource, record) => record.param('email') !== '',
          },
        },
      },
    },
  ],
}</code></pre><p><strong>isVisible</strong> can be either a function returning boolean value or a boolean value itself.</p>
<h3>Action handler</h3><p>Each action has an <a href="global.html#ActionHandler">ActionHandler</a> function. This function is executed every time the action is invoked.</p>
<p>Handler is an async fuction returning Promise which can either resolves to HTML string or to the redirect response.</p>
<p>This is how Edit action is defined:</p>
<pre class="prettyprint source"><code>module.exports = {
  name: 'edit',
  isVisible: true,
  actionType: 'record',
  icon: 'icomoon-edit',
  label: 'Edit',
  handler: async (request, response, data) => {
    if (request.method === 'get') {
      return renderer.render('actions/edit', data)
    }
    if (request.method === 'post') {
      await data.record.update(request.payload)
      if (data.record.isValid()) {
        const showAction = data.resource.decorate().actions.show
        return response.redirect(data.h.recordActionUrl(
          data.resource, showAction, data.record,
        ))
      }
      return renderer.render('actions/edit', data)
    }
  },
}
</code></pre><p>If request was <strong>get</strong> it renders the edit fields. Otherwise (<strong>post</strong>) updates the record.</p>
<h3>Example of modifying the show action</h3><p>Lets imagine we would like to add a graph to the details of the articles showing the number of comments.</p>
<p>We can update an <a href="global.html#ActionHandler">ActionHandler</a> and utilise the <a href="PageBuilder.html">PageBuilder</a> class.</p>
<p>This is how we would do this:</p>
<pre class="prettyprint source lang-javascript"><code>{
  ...,
  handler: async (request, response, data) => {
    const content = await AdminBro.ACTIONS.show.handler(request, response, data)
    const page = new AdminBro.PageBuilder({ admin: data._admin })
    page.addColumn({ content, columns: 7 })
    page.addChart({
      columns: 5,
      title: 'Popularity',
      subtitle: 'How people like this article',
      config: {
        type: 'bar',
        data: {
          datasets: [
            {
              label: 'Thumbs UP',
              fill: true,
              backgroundColor: AdminBro.PageBuilder.COLOR.INFO,
              data: [522]
            }, {
              label: 'Thumbs Down',
              fill: true,
              backgroundColor: AdminBro.PageBuilder.COLOR.WARNING,
              data: [20]
            },
          ],
        },
      }
    })
    return page.toHTML()
  },
  ...
}</code></pre><p>And this is the result</p>
<p><img src="./images/graph-in-show.png"></p>
<h2>Custom Actions</h2><p>Also you can define your own actions. Simply pass <a href="global.html#Action">Action</a> under a new key to <a href="global.html#ResourceOptions">ResourceOptions</a>.</p>
<p>Your action can be either Resource'is, Record'is or both.</p>
<pre class="prettyprint source lang-javascript"><code>const adminBroOptions = {
  resources: [
    { resource: Article,
      options: {
        actions: {
          newAction: {
            actionType: ['record'],
            label: 'Publish',
            icon: 'fas fa-eye',
            isVisible: true,
            handler: async () => {...}
          },
        },
      },
    },
  ],
}</code></pre><h2>What's next</h2><p>Make sure to check out following types definitions: </p>
<ul>
<li><a href="global.html#ResourceOptions">ResourceOptions</a></li>
<li><a href="global.html#Action">Action</a></li>
<li><a href="global.html#ActionHandler">ActionHandler</a></li>
<li><a href="global.html#IsVisible">IsVisible</a></li>
</ul>
<p>And you might also want to check out <a href="PageBuilder.html">PageBuilder</a></p>
</article>

</section>

                </div>
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Feb 14 2019 18:50:27 GMT+0100 (Central European Standard Time)</p>
        <p class="sidebar-created-by">
            <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
            <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers</a>
        </p>
    </div>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/app.min.js"></script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>